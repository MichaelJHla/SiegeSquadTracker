<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/operator-bans.css">
    <link rel="stylesheet" href="https://use.typekit.net/huf3guc.css">
    <title>Siege Squad Tracker - Operator Bans</title>
</head>

<body>
    <div id="header">
        <h1 id="squad-name"><a href="squad.html">Squad Name</a></h1>
        <div id="nav-elements">
            <h2><a href="map-bans.html">Map Ban Helper</a></h2>
            <h2><a href="#">Operator Bans</a></h2>
            <h2><a href="site-stats.html">Site Stat Tracker</a></h2>
        </div>
    </div>

    <div id="body">
        <div id="map-selection">
            <label for="map-list">Operator bans for:</label>
            <select id="map-list" onchange="loadBan()">
                <option disabled selected value> -- select a map -- </option>
                <option value="bank">Bank</option>
                <option value="border">Border</option>
                <option value="chalet">Chalet</option>
                <option value="clubhouse">Clubhouse</option>
                <option value="coastline">Coastline</option>
                <option value="consulate">Consulate</option>
                <option value="kafe">Kafe</option>
                <option value="kanal">Kanal</option>
                <option value="oregon">Oregon</option>
                <option value="outback">Outback</option>
                <option value="skyscraper">Skyscraper</option>
                <option value="park">Theme Park</option>
                <option value="villa">Villa</option>
            </select>
        </div>
        <div class="wrapper">
            <div id="edit-operators">
                <select id="attack-operators" class="operator-list">
                    <option disabled selected value="NA"> -- select an attack op -- </option>
                    <option value="none">No Ban</option>
                    <option value="ace">Ace</option>
                    <option value="amaru">Amaru</option>
                    <option value="ash">Ash</option>
                    <option value="blackbeard">Blackbeard</option>
                    <option value="blitz">Blitz</option>
                    <option value="buck">Buck</option>
                    <option value="capitao">Capitao</option>
                    <option value="dokkaebi">Dokkaebi</option>
                    <option value="finka">Finka</option>
                    <option value="fuze">Fuze</option>
                    <option value="glaz">Glaz</option>
                    <option value="gridlock">Gridlock</option>
                    <option value="hibana">Hibana</option>
                    <option value="iana">Iana</option>
                    <option value="iq">IQ</option>
                    <option value="jackal">Jackal</option>
                    <option value="kali">Kali</option>
                    <option value="lion">Lion</option>
                    <option value="maverick">Maverick</option>
                    <option value="Montagne">Montagne</option>
                    <option value="nokk">Nokk</option>
                    <option value="nomad">Nomad</option>
                    <option value="sledge">Sledge</option>
                    <option value="thatcher">Thatcher</option>
                    <option value="thermite">Thermite</option>
                    <option value="twitch">Twitch</option>
                    <option value="ying">Ying</option>
                    <option value="zero">Zero</option>
                    <option value="zofia">Zofia</option>
                </select>

                <select id="defense-operators" class="operator-list">
                    <option disabled selected value="NA"> -- select a defense op -- </option>
                    <option value="none">No Ban</option>
                    <option value="alibi">Alibi</option>
                    <option value="aruni">Aruni</option>
                    <option value="bandit">Bandit</option>
                    <option value="castle">Castle</option>
                    <option value="caveira">Caveira</option>
                    <option value="clash">Clash</option>
                    <option value="doc">Doc</option>
                    <option value="echo">Echo</option>
                    <option value="ela">Ela</option>
                    <option value="frost">Frost</option>
                    <option value="goyo">Goyo</option>
                    <option value="jager">Jager</option>
                    <option value="kaid">Kaid</option>
                    <option value="kapkan">Kapkan</option>
                    <option value="lesion">Lesion</option>
                    <option value="maestro">Maestro</option>
                    <option value="melusi">Melusi</option>
                    <option value="mira">Mira</option>
                    <option value="mozzie">Mozzie</option>
                    <option value="mute">Mute</option>
                    <option value="oryx">Oryx</option>
                    <option value="pulse">Pulse</option>
                    <option value="rook">Rook</option>
                    <option value="smoke">Smoke</option>
                    <option value="tachanka">Tachanka</option>
                    <option value="valkyrie">Valkyrie</option>
                    <option value="vigil">Vigil</option>
                    <option value="wamai">Wamai</option>
                    <option value="warden">Warden</option>
                </select>

                <button id="submit-bans" onclick="submitBan()">Submit changes</button>
            </div>
        </div>
        <div id="operator-display">
            <!--This will show the two operators selected to be banned on this map-->
            <img id="attack-operator">
            <img id="defense-operator">
        </div>
        <div id="edit-button">
            <button id="edit-bans" onclick="openEditScreen()">Edit bans</button>
        </div>
    </div>

    <div id="footer-div">
        <footer><!--This will tell the user who they are signed in as--></footer>
        <a href="../index.html">Change User</a>
    </div>
    
    <!--All scripts below here-->
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
    <!-- Database CDN -->
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>
    <!--Configuration information for firebase-->
    <script src="../scripts/firebaseConfig.js"></script>
    <!--jQuery import-->
    <script src="../scripts/jquery.js"></script>

    <!--Global script for setting up data between multiple pages-->
    <script src="../scripts/global.js"></script>

    <script>
        //This function is used to load and display the operator ban for the map
        function loadBan() {
            //This sets the dropdown back to default values
            $('#attack-operators').val('NA');
            $('#defense-operators').val('NA');
            //TODO HANDLE THE NA CASE WHEN SUBMITTING NEW BANS

            $('#edit-bans').show();
            $('.wrapper').hide();
            database.ref("squads/" + localStorage.getItem("squadName") + "/operator-bans/" + $('#map-list').val()).once('value').then(function(snapshot) {
                //Load and display the data regarding operator bans
                $('#attack-operator').attr("src", "../images/operators/" + snapshot.val().attacker + ".svg");
                $('#defense-operator').attr("src", "../images/operators/" + snapshot.val().defender + ".svg");
            });
        }

        //This function is used to submit the new ban information to the database
        function submitBan() {

            var map = $('#map-list').val();
            var dOp = $('#defense-operators').val();
            var aOp = $('#attack-operators').val();

            var reference = "squads/" + localStorage.getItem("squadName") + "/operator-bans/" + map + "/";

            database.ref(reference + "attacker").set(aOp);
            database.ref(reference + "defender").set(dOp);

            loadBan();
        }

        //Displays the proper items when a map's bans are to be edited
        function openEditScreen() {
            $('.wrapper').show();
            $('#edit-bans').hide();
        }
    </script>
</body>
</html>